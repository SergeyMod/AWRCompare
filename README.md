# Система сравнения отчетов AWR и pg_profile

Приложение для автоматического сравнения отчетов о производительности баз данных Oracle (AWR) и PostgreSQL (pg_profile).

## Описание

Данное приложение предназначено для автоматизации процесса сравнения отчетов о производительности баз данных. Поддерживаются следующие варианты сравнения:

- **Oracle AWR ↔ Oracle AWR** - сравнение отчетов с одного или разных серверов Oracle
- **PostgreSQL pg_profile ↔ PostgreSQL pg_profile** - сравнение отчетов с одного или разных серверов PostgreSQL  
- **Oracle AWR ↔ PostgreSQL pg_profile** - кросс-платформенное сравнение на уровне общих метрик

## Возможности

- Автоматическое определение типа и версии отчета
- Извлечение и структурирование данных из ключевых таблиц/секций
- Интеллектуальное сопоставление метрик при кросс-платформенном сравнении
- Интерактивный выбор таблиц для сравнения
- Настройка правил сравнения (пороговые значения, игнорируемые столбцы)
- Автоматическое вычисление абсолютных и относительных отклонений
- Выделение критических расхождений
- Экспорт результатов в HTML, CSV, JSON форматы
- Графический интерфейс пользователя

## Требования

- Python 3.8+
- Библиотеки из requirements.txt

## Установка

1. Клонируйте репозиторий или распакуйте архив
2. Установите зависимости:

```bash
pip install -r requirements.txt
```

## Запуск

Запуск приложения с графическим интерфейсом:

```bash
python main.py
```

## Структура проекта

```
AWRcompare/
├── config/                          # Конфигурационные файлы
│   ├── cross_platform_mapping.yaml  # Маппинг метрик между СУБД
│   └── default_comparison.yaml      # Настройки сравнения по умолчанию
├── src/                             # Исходный код
│   ├── parsers/                     # Парсеры отчетов
│   │   ├── base_parser.py          # Базовый класс парсера
│   │   ├── awr_parser.py           # Парсер AWR отчетов
│   │   └── pg_profile_parser.py    # Парсер pg_profile отчетов
│   ├── comparison/                  # Модуль сравнения
│   │   └── comparison_engine.py    # Движок сравнения
│   ├── report_generator/            # Генератор отчетов
│   │   └── report_generator.py     # Генерация отчетов в разных форматах
│   ├── gui/                         # Графический интерфейс
│   │   └── main_window.py          # Главное окно приложения
│   └── utils/                       # Утилиты
│       └── config_loader.py        # Загрузчик конфигурации
├── docs/                            # Документация
├── logs/                            # Логи приложения
├── main.py                          # Точка входа
├── requirements.txt                 # Зависимости
└── README.md                        # Этот файл
```

## Использование

### Через графический интерфейс

1. Запустите приложение: `python main.py`
2. Нажмите "Обзор..." для выбора базового отчета
3. Нажмите "Обзор..." для выбора целевого отчета
4. Нажмите "Загрузить отчеты"
5. Выберите таблицы для сравнения из списка
6. Нажмите "Сравнить"
7. Просмотрите результаты в окне приложения
8. При необходимости экспортируйте результаты в нужном формате

### Программное использование

```python
from src.parsers import AWRParser, PgProfileParser
from src.comparison import ComparisonEngine
from src.report_generator import ReportGenerator

# Создание парсеров
base_parser = AWRParser('path/to/base_report.html')
target_parser = AWRParser('path/to/target_report.html')

# Парсинг отчетов
base_parser.parse()
target_parser.parse()

# Сравнение
engine = ComparisonEngine()
results = engine.compare_reports(base_parser, target_parser)

# Генерация отчета
generator = ReportGenerator()
report = generator.generate_report(results, output_format='html', 
                                   output_path='comparison_report.html')
```

## Конфигурация

### Настройка маппинга метрик

Файл `config/cross_platform_mapping.yaml` содержит маппинг метрик между Oracle и PostgreSQL для кросс-платформенного сравнения.

### Настройка пороговых значений

Файл `config/default_comparison.yaml` содержит:
- Пороговые значения для предупреждений и критических отклонений
- Список игнорируемых столбцов
- Настройки форматирования вывода
- Параметры экспорта

## Форматы отчетов

### Поддерживаемые входные форматы

- HTML отчеты AWR (Oracle)
- Текстовые отчеты AWR (Oracle)
- HTML отчеты pg_profile (PostgreSQL)
- Текстовые отчеты pg_profile (PostgreSQL)

### Форматы экспорта

- **TEXT** - текстовый отчет с таблицами
- **HTML** - HTML отчет с форматированием и стилями
- **CSV** - CSV файл для анализа в Excel
- **JSON** - JSON для программной обработки

## Автор

Курсовая работа по дисциплине "Проектирование информационных систем"

## Лицензия

Учебный проект
